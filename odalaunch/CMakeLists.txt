# API
set(API_DIR ../odalpapi)
file(GLOB API_HEADERS ${API_DIR}/*.h)
file(GLOB API_SOURCES ${API_DIR}/*.cpp)

# Odalaunch
set(LAUNCH_DIR res src)
file(GLOB LAUNCH_HEADERS res/*.h src/*.h)
file(GLOB LAUNCH_SOURCES src/*.cpp)

# Build Resource Directory
# This file is generated by the build process.
set(XRCRES_DIR ${CMAKE_CURRENT_BINARY_DIR}/res)
set(XRCRES_HEADER ${XRCRES_DIR}/xrc_resource.h)

# Odalaunch definitions
include_directories(${API_DIR} ${LAUNCH_DIR} ${XRCRES_DIR})

# wxWidgets configuration
find_package(wxWidgets)
if(wxWidgets_FOUND)
  include( "${wxWidgets_USE_FILE}" )
else()
  if(wxWidgets_ROOT_DIR)
    message(WARNING "wxWidgets root directory exists but no compiled libraries were found, odalaunch target not generated.")
  else()
    message(WARNING "wxWidgets not found, odalaunch target not generated.")
  endif()
endif()

# Odalaunch target
if(wxWidgets_FOUND)
  add_custom_command(
    OUTPUT ${XRCRES_HEADER}
    COMMAND ${wxWidgets_wxrc_EXECUTABLE} -c -o ${XRCRES_HEADER} res/*.xrc)
  add_executable(odalaunch
    ${API_SOURCES} ${API_HEADERS}
    ${LAUNCH_SOURCES} ${LAUNCH_HEADERS}
    ${XRCRES_HEADER})
  target_link_libraries(odalaunch ${wxWidgets_LIBRARIES})
endif()
